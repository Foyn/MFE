#coding=utf-8
#__author__='YHR'
from imbalanced_ensemble.ensemble import  SelfPacedEnsembleClassifier, BalanceCascadeClassifier
from sklearn.neural_network import  MLPClassifier
from sklearn.ensemble import AdaBoostClassifier
from sklearn.tree import DecisionTreeClassifier
from imblearn.under_sampling import RandomUnderSampler
import pandas as pd
import numpy as np
from sklearn.metrics import average_precision_score, precision_recall_curve, auc, \
    confusion_matrix, classification_report, accuracy_score
import cv2
import lightgbm as lgb

import os

def spe(trainx, trainy, testx, testy):
    baseClassifier = MLPClassifier(hidden_layer_sizes=(64, 32, 16,), max_iter=100, batch_size=128, learning_rate_init=0.01)
    # baseClassifier = lgb.LGBMClassifier()
    # clf = SelfPacedEnsembleClassifier(base_estimator=baseClassifier, n_estimators=100)  # 建立EasyEnsemble模型对象
    clf = BalanceCascadeClassifier(base_estimator=baseClassifier, n_estimators=50)  # 建立EasyEnsemble模型对象
    print('begin fit...')
    clf.fit(trainx, trainy)
    print('finish fit...')
    test_pred_prob = clf.predict_proba(testx)
    tstPred = np.argmax(test_pred_prob, axis=-1)
    test_pred_prob = test_pred_prob[:, -1]

    pr_score = average_precision_score(testy, test_pred_prob)
    accuracy = accuracy_score(testy, tstPred)

    confusemat = confusion_matrix(testy, tstPred)
    classrpt = classification_report(testy, tstPred)
    print(confusemat)
    print(classrpt)
    print("pr_score: ", pr_score)
    TN = confusemat[0][0]
    FP = confusemat[0][1]
    FN = confusemat[1][0]
    TP = confusemat[1][1]
    GM = np.sqrt(((TP) / (TP + FP)) * (TP / (TP + FN)))
    MCC = (TP * TN - FP * FN) / np.sqrt((TP + FP) * (TP + FN) * (TN + FP) * (TN + FN) + 0.0000001)
    print("GM: ", GM)
    print("MCC: ", MCC)
    print("accuracy: ", accuracy)

    pass

def trainandsplit(x, label = 0):
    x = np.array(x)
    trainx = x[:480];  trainy = np.ones(len(trainx))*label
    testx= x[480:] ;  testy = np.ones(len(testx))*label

    return trainx, trainy, testx, testy

def readtwoclass(prefix):
    data = pd.read_csv(prefix+"train.csv")

    # n01532829
    c0 = data[data['label'] == "n01532829"]['filename'].reset_index(drop=True).values.tolist()
    # n01558993
    c1 = data[data['label'] == "n01558993"]['filename'].reset_index(drop=True).values.tolist()

    '''
    ['n0153282900000005.jpg', 'n0153282900000006.jpg', 'n0153282900000007.jpg', 'n0153282900000010.jpg', 'n0153282900000014.jpg', 'n0153282900000015.jpg', 'n0153282900000016.jpg', 'n0153282900000017.jpg', 'n0153282900000018.jpg', 'n0153282900000019.jpg', 'n0153282900000020.jpg', 'n0153282900000021.jpg', 'n0153282900000023.jpg', 'n0153282900000028.jpg', 'n0153282900000031.jpg', 'n0153282900000033.jpg', 'n0153282900000034.jpg', 'n0153282900000036.jpg', 'n0153282900000037.jpg', 'n0153282900000038.jpg', 'n0153282900000040.jpg', 'n0153282900000041.jpg', 'n0153282900000042.jpg', 'n0153282900000046.jpg', 'n0153282900000048.jpg', 'n0153282900000049.jpg', 'n0153282900000051.jpg', 'n0153282900000053.jpg', 'n0153282900000058.jpg', 'n0153282900000059.jpg', 'n0153282900000062.jpg', 'n0153282900000063.jpg', 'n0153282900000066.jpg', 'n0153282900000068.jpg', 'n0153282900000069.jpg', 'n0153282900000070.jpg', 'n0153282900000074.jpg', 'n0153282900000076.jpg', 'n0153282900000078.jpg', 'n0153282900000083.jpg', 'n0153282900000084.jpg', 'n0153282900000087.jpg', 'n0153282900000088.jpg', 'n0153282900000090.jpg', 'n0153282900000091.jpg', 'n0153282900000097.jpg', 'n0153282900000099.jpg', 'n0153282900000102.jpg', 'n0153282900000105.jpg', 'n0153282900000111.jpg', 'n0153282900000112.jpg', 'n0153282900000113.jpg', 'n0153282900000116.jpg', 'n0153282900000118.jpg', 'n0153282900000120.jpg', 'n0153282900000121.jpg', 'n0153282900000122.jpg', 'n0153282900000123.jpg', 'n0153282900000127.jpg', 'n0153282900000131.jpg', 'n0153282900000134.jpg', 'n0153282900000135.jpg', 'n0153282900000136.jpg', 'n0153282900000137.jpg', 'n0153282900000138.jpg', 'n0153282900000140.jpg', 'n0153282900000142.jpg', 'n0153282900000145.jpg', 'n0153282900000146.jpg', 'n0153282900000147.jpg', 'n0153282900000150.jpg', 'n0153282900000151.jpg', 'n0153282900000154.jpg', 'n0153282900000155.jpg', 'n0153282900000156.jpg', 'n0153282900000157.jpg', 'n0153282900000158.jpg', 'n0153282900000159.jpg', 'n0153282900000162.jpg', 'n0153282900000163.jpg', 'n0153282900000164.jpg', 'n0153282900000165.jpg', 'n0153282900000167.jpg', 'n0153282900000168.jpg', 'n0153282900000171.jpg', 'n0153282900000179.jpg', 'n0153282900000181.jpg', 'n0153282900000183.jpg', 'n0153282900000185.jpg', 'n0153282900000193.jpg', 'n0153282900000194.jpg', 'n0153282900000198.jpg', 'n0153282900000199.jpg', 'n0153282900000203.jpg', 'n0153282900000204.jpg', 'n0153282900000205.jpg', 'n0153282900000207.jpg', 'n0153282900000209.jpg', 'n0153282900000210.jpg', 'n0153282900000211.jpg', 'n0153282900000212.jpg', 'n0153282900000214.jpg', 'n0153282900000215.jpg', 'n0153282900000216.jpg', 'n0153282900000219.jpg', 'n0153282900000220.jpg', 'n0153282900000224.jpg', 'n0153282900000225.jpg', 'n0153282900000226.jpg', 'n0153282900000228.jpg', 'n0153282900000230.jpg', 'n0153282900000231.jpg', 'n0153282900000234.jpg', 'n0153282900000236.jpg', 'n0153282900000238.jpg', 'n0153282900000239.jpg', 'n0153282900000240.jpg', 'n0153282900000243.jpg', 'n0153282900000244.jpg', 'n0153282900000250.jpg', 'n0153282900000253.jpg', 'n0153282900000255.jpg', 'n0153282900000256.jpg', 'n0153282900000258.jpg', 'n0153282900000259.jpg', 'n0153282900000261.jpg', 'n0153282900000262.jpg', 'n0153282900000263.jpg', 'n0153282900000265.jpg', 'n0153282900000266.jpg', 'n0153282900000269.jpg', 'n0153282900000272.jpg', 'n0153282900000274.jpg', 'n0153282900000275.jpg', 'n0153282900000276.jpg', 'n0153282900000286.jpg', 'n0153282900000291.jpg', 'n0153282900000295.jpg', 'n0153282900000298.jpg', 'n0153282900000300.jpg', 'n0153282900000301.jpg', 'n0153282900000304.jpg', 'n0153282900000305.jpg', 'n0153282900000307.jpg', 'n0153282900000309.jpg', 'n0153282900000310.jpg', 'n0153282900000311.jpg', 'n0153282900000316.jpg', 'n0153282900000317.jpg', 'n0153282900000318.jpg', 'n0153282900000319.jpg', 'n0153282900000320.jpg', 'n0153282900000321.jpg', 'n0153282900000322.jpg', 'n0153282900000323.jpg', 'n0153282900000324.jpg', 'n0153282900000327.jpg', 'n0153282900000329.jpg', 'n0153282900000335.jpg', 'n0153282900000337.jpg', 'n0153282900000339.jpg', 'n0153282900000342.jpg', 'n0153282900000344.jpg', 'n0153282900000348.jpg', 'n0153282900000349.jpg', 'n0153282900000352.jpg', 'n0153282900000353.jpg', 'n0153282900000354.jpg', 'n0153282900000355.jpg', 'n0153282900000356.jpg', 'n0153282900000359.jpg', 'n0153282900000364.jpg', 'n0153282900000365.jpg', 'n0153282900000367.jpg', 'n0153282900000369.jpg', 'n0153282900000371.jpg', 'n0153282900000372.jpg', 'n0153282900000375.jpg', 'n0153282900000376.jpg', 'n0153282900000377.jpg', 'n0153282900000381.jpg', 'n0153282900000382.jpg', 'n0153282900000383.jpg', 'n0153282900000384.jpg', 'n0153282900000387.jpg', 'n0153282900000389.jpg', 'n0153282900000394.jpg', 'n0153282900000398.jpg', 'n0153282900000401.jpg', 'n0153282900000403.jpg', 'n0153282900000406.jpg', 'n0153282900000409.jpg', 'n0153282900000412.jpg', 'n0153282900000413.jpg', 'n0153282900000417.jpg', 'n0153282900000419.jpg', 'n0153282900000421.jpg', 'n0153282900000422.jpg', 'n0153282900000425.jpg', 'n0153282900000427.jpg', 'n0153282900000428.jpg', 'n0153282900000429.jpg', 'n0153282900000430.jpg', 'n0153282900000435.jpg', 'n0153282900000436.jpg', 'n0153282900000439.jpg', 'n0153282900000446.jpg', 'n0153282900000453.jpg', 'n0153282900000455.jpg', 'n0153282900000457.jpg', 'n0153282900000459.jpg', 'n0153282900000461.jpg', 'n0153282900000465.jpg', 'n0153282900000467.jpg', 'n0153282900000468.jpg', 'n0153282900000469.jpg', 'n0153282900000470.jpg', 'n0153282900000474.jpg', 'n0153282900000476.jpg', 'n0153282900000477.jpg', 'n0153282900000478.jpg', 'n0153282900000479.jpg', 'n0153282900000480.jpg', 'n0153282900000484.jpg', 'n0153282900000488.jpg', 'n0153282900000490.jpg', 'n0153282900000496.jpg', 'n0153282900000497.jpg', 'n0153282900000499.jpg', 'n0153282900000501.jpg', 'n0153282900000502.jpg', 'n0153282900000503.jpg', 'n0153282900000504.jpg', 'n0153282900000507.jpg', 'n0153282900000508.jpg', 'n0153282900000509.jpg', 'n0153282900000511.jpg', 'n0153282900000519.jpg', 'n0153282900000523.jpg', 'n0153282900000525.jpg', 'n0153282900000527.jpg', 'n0153282900000529.jpg', 'n0153282900000530.jpg', 'n0153282900000531.jpg', 'n0153282900000534.jpg', 'n0153282900000535.jpg', 'n0153282900000537.jpg', 'n0153282900000540.jpg', 'n0153282900000546.jpg', 'n0153282900000547.jpg', 'n0153282900000548.jpg', 'n0153282900000550.jpg', 'n0153282900000552.jpg', 'n0153282900000553.jpg', 'n0153282900000555.jpg', 'n0153282900000556.jpg', 'n0153282900000560.jpg', 'n0153282900000561.jpg', 'n0153282900000562.jpg', 'n0153282900000564.jpg', 'n0153282900000569.jpg', 'n0153282900000571.jpg', 'n0153282900000572.jpg', 'n0153282900000574.jpg', 'n0153282900000577.jpg', 'n0153282900000579.jpg', 'n0153282900000580.jpg', 'n0153282900000584.jpg', 'n0153282900000585.jpg', 'n0153282900000589.jpg', 'n0153282900000592.jpg', 'n0153282900000595.jpg', 'n0153282900000596.jpg', 'n0153282900000598.jpg', 'n0153282900000600.jpg', 'n0153282900000605.jpg', 'n0153282900000606.jpg', 'n0153282900000607.jpg', 'n0153282900000610.jpg', 'n0153282900000613.jpg', 'n0153282900000615.jpg', 'n0153282900000616.jpg', 'n0153282900000620.jpg', 'n0153282900000622.jpg', 'n0153282900000623.jpg', 'n0153282900000624.jpg', 'n0153282900000626.jpg', 'n0153282900000627.jpg', 'n0153282900000630.jpg', 'n0153282900000631.jpg', 'n0153282900000632.jpg', 'n0153282900000633.jpg', 'n0153282900000634.jpg', 'n0153282900000636.jpg', 'n0153282900000641.jpg', 'n0153282900000642.jpg', 'n0153282900000644.jpg', 'n0153282900000650.jpg', 'n0153282900000651.jpg', 'n0153282900000652.jpg', 'n0153282900000653.jpg', 'n0153282900000654.jpg', 'n0153282900000658.jpg', 'n0153282900000660.jpg', 'n0153282900000663.jpg', 'n0153282900000665.jpg', 'n0153282900000666.jpg', 'n0153282900000668.jpg', 'n0153282900000669.jpg', 'n0153282900000673.jpg', 'n0153282900000675.jpg', 'n0153282900000679.jpg', 'n0153282900000681.jpg', 'n0153282900000682.jpg', 'n0153282900000687.jpg', 'n0153282900000688.jpg', 'n0153282900000693.jpg', 'n0153282900000694.jpg', 'n0153282900000695.jpg', 'n0153282900000696.jpg', 'n0153282900000700.jpg', 'n0153282900000703.jpg', 'n0153282900000707.jpg', 'n0153282900000708.jpg', 'n0153282900000709.jpg', 'n0153282900000712.jpg', 'n0153282900000714.jpg', 'n0153282900000720.jpg', 'n0153282900000722.jpg', 'n0153282900000724.jpg', 'n0153282900000728.jpg', 'n0153282900000729.jpg', 'n0153282900000730.jpg', 'n0153282900000732.jpg', 'n0153282900000733.jpg', 'n0153282900000745.jpg', 'n0153282900000747.jpg', 'n0153282900000749.jpg', 'n0153282900000751.jpg', 'n0153282900000752.jpg', 'n0153282900000753.jpg', 'n0153282900000754.jpg', 'n0153282900000755.jpg', 'n0153282900000756.jpg', 'n0153282900000758.jpg', 'n0153282900000760.jpg', 'n0153282900000761.jpg', 'n0153282900000762.jpg', 'n0153282900000764.jpg', 'n0153282900000768.jpg', 'n0153282900000769.jpg', 'n0153282900000772.jpg', 'n0153282900000774.jpg', 'n0153282900000777.jpg', 'n0153282900000779.jpg', 'n0153282900000782.jpg', 'n0153282900000783.jpg', 'n0153282900000787.jpg', 'n0153282900000788.jpg', 'n0153282900000789.jpg', 'n0153282900000791.jpg', 'n0153282900000792.jpg', 'n0153282900000795.jpg', 'n0153282900000796.jpg', 'n0153282900000798.jpg', 'n0153282900000799.jpg', 'n0153282900000802.jpg', 'n0153282900000805.jpg', 'n0153282900000806.jpg', 'n0153282900000809.jpg', 'n0153282900000810.jpg', 'n0153282900000811.jpg', 'n0153282900000813.jpg', 'n0153282900000815.jpg', 'n0153282900000818.jpg', 'n0153282900000821.jpg', 'n0153282900000825.jpg', 'n0153282900000827.jpg', 'n0153282900000828.jpg', 'n0153282900000829.jpg', 'n0153282900000833.jpg', 'n0153282900000834.jpg', 'n0153282900000840.jpg', 'n0153282900000841.jpg', 'n0153282900000842.jpg', 'n0153282900000843.jpg', 'n0153282900000846.jpg', 'n0153282900000848.jpg', 'n0153282900000850.jpg', 'n0153282900000851.jpg', 'n0153282900000855.jpg', 'n0153282900000856.jpg', 'n0153282900000857.jpg', 'n0153282900000867.jpg', 'n0153282900000868.jpg', 'n0153282900000869.jpg', 'n0153282900000873.jpg', 'n0153282900000874.jpg', 'n0153282900000876.jpg', 'n0153282900000877.jpg', 'n0153282900000878.jpg', 'n0153282900000881.jpg', 'n0153282900000883.jpg', 'n0153282900000887.jpg', 'n0153282900000890.jpg', 'n0153282900000892.jpg', 'n0153282900000893.jpg', 'n0153282900000894.jpg', 'n0153282900000897.jpg', 'n0153282900000898.jpg', 'n0153282900000900.jpg', 'n0153282900000903.jpg', 'n0153282900000907.jpg', 'n0153282900000911.jpg', 'n0153282900000912.jpg', 'n0153282900000915.jpg', 'n0153282900000918.jpg', 'n0153282900000925.jpg', 'n0153282900000926.jpg', 'n0153282900000929.jpg', 'n0153282900000930.jpg', 'n0153282900000931.jpg', 'n0153282900000935.jpg', 'n0153282900000937.jpg', 'n0153282900000938.jpg', 'n0153282900000939.jpg', 'n0153282900000940.jpg', 'n0153282900000942.jpg', 'n0153282900000943.jpg', 'n0153282900000945.jpg', 'n0153282900000946.jpg', 'n0153282900000947.jpg', 'n0153282900000951.jpg', 'n0153282900000953.jpg', 'n0153282900000955.jpg', 'n0153282900000957.jpg', 'n0153282900000961.jpg', 'n0153282900000962.jpg', 'n0153282900000963.jpg', 'n0153282900000964.jpg', 'n0153282900000965.jpg', 'n0153282900000966.jpg', 'n0153282900000968.jpg', 'n0153282900000970.jpg', 'n0153282900000975.jpg', 'n0153282900000976.jpg', 'n0153282900000977.jpg', 'n0153282900000983.jpg', 'n0153282900000985.jpg', 'n0153282900000987.jpg', 'n0153282900000988.jpg', 'n0153282900000989.jpg', 'n0153282900000990.jpg', 'n0153282900000994.jpg', 'n0153282900000995.jpg', 'n0153282900000998.jpg', 'n0153282900001000.jpg', 'n0153282900001002.jpg', 'n0153282900001004.jpg', 'n0153282900001006.jpg', 'n0153282900001008.jpg', 'n0153282900001009.jpg', 'n0153282900001013.jpg', 'n0153282900001018.jpg', 'n0153282900001019.jpg', 'n0153282900001020.jpg', 'n0153282900001024.jpg', 'n0153282900001026.jpg', 'n0153282900001028.jpg', 'n0153282900001030.jpg', 'n0153282900001031.jpg', 'n0153282900001033.jpg', 'n0153282900001034.jpg', 'n0153282900001036.jpg', 'n0153282900001043.jpg', 'n0153282900001045.jpg', 'n0153282900001046.jpg', 'n0153282900001047.jpg', 'n0153282900001048.jpg', 'n0153282900001052.jpg', 'n0153282900001053.jpg', 'n0153282900001055.jpg', 'n0153282900001057.jpg', 'n0153282900001061.jpg', 'n0153282900001064.jpg', 'n0153282900001065.jpg', 'n0153282900001069.jpg', 'n0153282900001070.jpg', 'n0153282900001075.jpg', 'n0153282900001078.jpg', 'n0153282900001082.jpg', 'n0153282900001084.jpg', 'n0153282900001085.jpg', 'n0153282900001086.jpg', 'n0153282900001087.jpg', 'n0153282900001088.jpg', 'n0153282900001090.jpg', 'n0153282900001091.jpg', 'n0153282900001093.jpg', 'n0153282900001094.jpg', 'n0153282900001095.jpg', 'n0153282900001099.jpg', 'n0153282900001100.jpg', 'n0153282900001101.jpg', 'n0153282900001102.jpg', 'n0153282900001107.jpg', 'n0153282900001112.jpg', 'n0153282900001113.jpg', 'n0153282900001114.jpg', 'n0153282900001117.jpg', 'n0153282900001119.jpg', 'n0153282900001120.jpg', 'n0153282900001124.jpg', 'n0153282900001127.jpg', 'n0153282900001128.jpg', 'n0153282900001129.jpg', 'n0153282900001131.jpg', 'n0153282900001132.jpg', 'n0153282900001134.jpg', 'n0153282900001138.jpg', 'n0153282900001139.jpg', 'n0153282900001140.jpg', 'n0153282900001143.jpg', 'n0153282900001144.jpg', 'n0153282900001145.jpg', 'n0153282900001147.jpg', 'n0153282900001148.jpg', 'n0153282900001152.jpg', 'n0153282900001153.jpg', 'n0153282900001154.jpg', 'n0153282900001155.jpg', 'n0153282900001160.jpg', 'n0153282900001161.jpg', 'n0153282900001162.jpg', 'n0153282900001166.jpg', 'n0153282900001167.jpg', 'n0153282900001168.jpg', 'n0153282900001170.jpg', 'n0153282900001171.jpg', 'n0153282900001172.jpg', 'n0153282900001173.jpg', 'n0153282900001175.jpg', 'n0153282900001177.jpg', 'n0153282900001180.jpg', 'n0153282900001181.jpg', 'n0153282900001183.jpg', 'n0153282900001184.jpg', 'n0153282900001185.jpg', 'n0153282900001186.jpg', 'n0153282900001189.jpg', 'n0153282900001191.jpg', 'n0153282900001196.jpg', 'n0153282900001197.jpg', 'n0153282900001199.jpg', 'n0153282900001201.jpg', 'n0153282900001203.jpg', 'n0153282900001205.jpg', 'n0153282900001206.jpg', 'n0153282900001207.jpg', 'n0153282900001210.jpg', 'n0153282900001212.jpg', 'n0153282900001215.jpg', 'n0153282900001216.jpg', 'n0153282900001217.jpg', 'n0153282900001220.jpg', 'n0153282900001222.jpg', 'n0153282900001223.jpg', 'n0153282900001225.jpg', 'n0153282900001227.jpg', 'n0153282900001230.jpg', 'n0153282900001231.jpg', 'n0153282900001232.jpg', 'n0153282900001236.jpg', 'n0153282900001238.jpg', 'n0153282900001239.jpg', 'n0153282900001240.jpg', 'n0153282900001241.jpg', 'n0153282900001247.jpg', 'n0153282900001253.jpg', 'n0153282900001255.jpg', 'n0153282900001257.jpg', 'n0153282900001259.jpg', 'n0153282900001263.jpg', 'n0153282900001264.jpg', 'n0153282900001265.jpg', 'n0153282900001268.jpg', 'n0153282900001273.jpg', 'n0153282900001274.jpg', 'n0153282900001276.jpg', 'n0153282900001278.jpg', 'n0153282900001279.jpg', 'n0153282900001281.jpg', 'n0153282900001284.jpg', 'n0153282900001287.jpg', 'n0153282900001288.jpg', 'n0153282900001290.jpg', 'n0153282900001291.jpg', 'n0153282900001295.jpg', 'n0153282900001297.jpg', 'n0153282900001298.jpg']
    ['n0155899300000001.jpg', 'n0155899300000002.jpg', 'n0155899300000003.jpg', 'n0155899300000005.jpg', 'n0155899300000006.jpg', 'n0155899300000008.jpg', 'n0155899300000012.jpg', 'n0155899300000013.jpg', 'n0155899300000015.jpg', 'n0155899300000017.jpg', 'n0155899300000018.jpg', 'n0155899300000020.jpg', 'n0155899300000021.jpg', 'n0155899300000024.jpg', 'n0155899300000025.jpg', 'n0155899300000029.jpg', 'n0155899300000032.jpg', 'n0155899300000037.jpg', 'n0155899300000038.jpg', 'n0155899300000041.jpg', 'n0155899300000046.jpg', 'n0155899300000047.jpg', 'n0155899300000049.jpg', 'n0155899300000051.jpg', 'n0155899300000052.jpg', 'n0155899300000053.jpg', 'n0155899300000054.jpg', 'n0155899300000055.jpg', 'n0155899300000056.jpg', 'n0155899300000059.jpg', 'n0155899300000060.jpg', 'n0155899300000062.jpg', 'n0155899300000070.jpg', 'n0155899300000071.jpg', 'n0155899300000072.jpg', 'n0155899300000073.jpg', 'n0155899300000074.jpg', 'n0155899300000080.jpg', 'n0155899300000082.jpg', 'n0155899300000085.jpg', 'n0155899300000089.jpg', 'n0155899300000091.jpg', 'n0155899300000093.jpg', 'n0155899300000094.jpg', 'n0155899300000095.jpg', 'n0155899300000096.jpg', 'n0155899300000098.jpg', 'n0155899300000102.jpg', 'n0155899300000107.jpg', 'n0155899300000108.jpg', 'n0155899300000109.jpg', 'n0155899300000110.jpg', 'n0155899300000111.jpg', 'n0155899300000112.jpg', 'n0155899300000113.jpg', 'n0155899300000115.jpg', 'n0155899300000117.jpg', 'n0155899300000121.jpg', 'n0155899300000122.jpg', 'n0155899300000125.jpg', 'n0155899300000130.jpg', 'n0155899300000132.jpg', 'n0155899300000137.jpg', 'n0155899300000139.jpg', 'n0155899300000140.jpg', 'n0155899300000141.jpg', 'n0155899300000144.jpg', 'n0155899300000145.jpg', 'n0155899300000147.jpg', 'n0155899300000149.jpg', 'n0155899300000150.jpg', 'n0155899300000152.jpg', 'n0155899300000160.jpg', 'n0155899300000162.jpg', 'n0155899300000163.jpg', 'n0155899300000164.jpg', 'n0155899300000166.jpg', 'n0155899300000167.jpg', 'n0155899300000168.jpg', 'n0155899300000170.jpg', 'n0155899300000171.jpg', 'n0155899300000172.jpg', 'n0155899300000177.jpg', 'n0155899300000178.jpg', 'n0155899300000180.jpg', 'n0155899300000186.jpg', 'n0155899300000187.jpg', 'n0155899300000188.jpg', 'n0155899300000189.jpg', 'n0155899300000190.jpg', 'n0155899300000191.jpg', 'n0155899300000192.jpg', 'n0155899300000193.jpg', 'n0155899300000194.jpg', 'n0155899300000198.jpg', 'n0155899300000200.jpg', 'n0155899300000203.jpg', 'n0155899300000204.jpg', 'n0155899300000206.jpg', 'n0155899300000207.jpg', 'n0155899300000208.jpg', 'n0155899300000209.jpg', 'n0155899300000210.jpg', 'n0155899300000211.jpg', 'n0155899300000212.jpg', 'n0155899300000213.jpg', 'n0155899300000215.jpg', 'n0155899300000216.jpg', 'n0155899300000217.jpg', 'n0155899300000218.jpg', 'n0155899300000219.jpg', 'n0155899300000220.jpg', 'n0155899300000223.jpg', 'n0155899300000226.jpg', 'n0155899300000227.jpg', 'n0155899300000228.jpg', 'n0155899300000229.jpg', 'n0155899300000230.jpg', 'n0155899300000231.jpg', 'n0155899300000233.jpg', 'n0155899300000234.jpg', 'n0155899300000238.jpg', 'n0155899300000241.jpg', 'n0155899300000243.jpg', 'n0155899300000247.jpg', 'n0155899300000253.jpg', 'n0155899300000254.jpg', 'n0155899300000257.jpg', 'n0155899300000258.jpg', 'n0155899300000259.jpg', 'n0155899300000260.jpg', 'n0155899300000262.jpg', 'n0155899300000264.jpg', 'n0155899300000266.jpg', 'n0155899300000268.jpg', 'n0155899300000269.jpg', 'n0155899300000270.jpg', 'n0155899300000271.jpg', 'n0155899300000276.jpg', 'n0155899300000277.jpg', 'n0155899300000278.jpg', 'n0155899300000280.jpg', 'n0155899300000281.jpg', 'n0155899300000284.jpg', 'n0155899300000285.jpg', 'n0155899300000287.jpg', 'n0155899300000289.jpg', 'n0155899300000290.jpg', 'n0155899300000291.jpg', 'n0155899300000292.jpg', 'n0155899300000294.jpg', 'n0155899300000297.jpg', 'n0155899300000300.jpg', 'n0155899300000301.jpg', 'n0155899300000302.jpg', 'n0155899300000303.jpg', 'n0155899300000304.jpg', 'n0155899300000306.jpg', 'n0155899300000311.jpg', 'n0155899300000313.jpg', 'n0155899300000318.jpg', 'n0155899300000319.jpg', 'n0155899300000320.jpg', 'n0155899300000323.jpg', 'n0155899300000324.jpg', 'n0155899300000326.jpg', 'n0155899300000327.jpg', 'n0155899300000328.jpg', 'n0155899300000331.jpg', 'n0155899300000332.jpg', 'n0155899300000333.jpg', 'n0155899300000335.jpg', 'n0155899300000337.jpg', 'n0155899300000339.jpg', 'n0155899300000342.jpg', 'n0155899300000345.jpg', 'n0155899300000356.jpg', 'n0155899300000357.jpg', 'n0155899300000361.jpg', 'n0155899300000365.jpg', 'n0155899300000366.jpg', 'n0155899300000367.jpg', 'n0155899300000374.jpg', 'n0155899300000376.jpg', 'n0155899300000377.jpg', 'n0155899300000378.jpg', 'n0155899300000380.jpg', 'n0155899300000383.jpg', 'n0155899300000384.jpg', 'n0155899300000385.jpg', 'n0155899300000386.jpg', 'n0155899300000387.jpg', 'n0155899300000391.jpg', 'n0155899300000393.jpg', 'n0155899300000396.jpg', 'n0155899300000398.jpg', 'n0155899300000399.jpg', 'n0155899300000404.jpg', 'n0155899300000406.jpg', 'n0155899300000407.jpg', 'n0155899300000409.jpg', 'n0155899300000420.jpg', 'n0155899300000422.jpg', 'n0155899300000423.jpg', 'n0155899300000424.jpg', 'n0155899300000425.jpg', 'n0155899300000428.jpg', 'n0155899300000429.jpg', 'n0155899300000430.jpg', 'n0155899300000433.jpg', 'n0155899300000436.jpg', 'n0155899300000437.jpg', 'n0155899300000438.jpg', 'n0155899300000439.jpg', 'n0155899300000440.jpg', 'n0155899300000442.jpg', 'n0155899300000443.jpg', 'n0155899300000445.jpg', 'n0155899300000448.jpg', 'n0155899300000450.jpg', 'n0155899300000453.jpg', 'n0155899300000457.jpg', 'n0155899300000458.jpg', 'n0155899300000460.jpg', 'n0155899300000461.jpg', 'n0155899300000463.jpg', 'n0155899300000464.jpg', 'n0155899300000466.jpg', 'n0155899300000469.jpg', 'n0155899300000470.jpg', 'n0155899300000471.jpg', 'n0155899300000476.jpg', 'n0155899300000480.jpg', 'n0155899300000482.jpg', 'n0155899300000487.jpg', 'n0155899300000490.jpg', 'n0155899300000491.jpg', 'n0155899300000492.jpg', 'n0155899300000493.jpg', 'n0155899300000494.jpg', 'n0155899300000495.jpg', 'n0155899300000498.jpg', 'n0155899300000499.jpg', 'n0155899300000500.jpg', 'n0155899300000503.jpg', 'n0155899300000504.jpg', 'n0155899300000506.jpg', 'n0155899300000507.jpg', 'n0155899300000508.jpg', 'n0155899300000509.jpg', 'n0155899300000510.jpg', 'n0155899300000514.jpg', 'n0155899300000515.jpg', 'n0155899300000516.jpg', 'n0155899300000517.jpg', 'n0155899300000518.jpg', 'n0155899300000520.jpg', 'n0155899300000525.jpg', 'n0155899300000527.jpg', 'n0155899300000530.jpg', 'n0155899300000531.jpg', 'n0155899300000534.jpg', 'n0155899300000535.jpg', 'n0155899300000536.jpg', 'n0155899300000537.jpg', 'n0155899300000538.jpg', 'n0155899300000539.jpg', 'n0155899300000540.jpg', 'n0155899300000547.jpg', 'n0155899300000551.jpg', 'n0155899300000557.jpg', 'n0155899300000559.jpg', 'n0155899300000569.jpg', 'n0155899300000570.jpg', 'n0155899300000573.jpg', 'n0155899300000574.jpg', 'n0155899300000576.jpg', 'n0155899300000577.jpg', 'n0155899300000578.jpg', 'n0155899300000580.jpg', 'n0155899300000582.jpg', 'n0155899300000583.jpg', 'n0155899300000585.jpg', 'n0155899300000586.jpg', 'n0155899300000587.jpg', 'n0155899300000589.jpg', 'n0155899300000591.jpg', 'n0155899300000600.jpg', 'n0155899300000602.jpg', 'n0155899300000604.jpg', 'n0155899300000606.jpg', 'n0155899300000608.jpg', 'n0155899300000611.jpg', 'n0155899300000614.jpg', 'n0155899300000616.jpg', 'n0155899300000618.jpg', 'n0155899300000620.jpg', 'n0155899300000621.jpg', 'n0155899300000622.jpg', 'n0155899300000623.jpg', 'n0155899300000624.jpg', 'n0155899300000625.jpg', 'n0155899300000626.jpg', 'n0155899300000627.jpg', 'n0155899300000630.jpg', 'n0155899300000633.jpg', 'n0155899300000634.jpg', 'n0155899300000635.jpg', 'n0155899300000636.jpg', 'n0155899300000637.jpg', 'n0155899300000639.jpg', 'n0155899300000641.jpg', 'n0155899300000642.jpg', 'n0155899300000643.jpg', 'n0155899300000644.jpg', 'n0155899300000647.jpg', 'n0155899300000648.jpg', 'n0155899300000649.jpg', 'n0155899300000653.jpg', 'n0155899300000654.jpg', 'n0155899300000656.jpg', 'n0155899300000657.jpg', 'n0155899300000660.jpg', 'n0155899300000661.jpg', 'n0155899300000662.jpg', 'n0155899300000663.jpg', 'n0155899300000665.jpg', 'n0155899300000666.jpg', 'n0155899300000672.jpg', 'n0155899300000675.jpg', 'n0155899300000676.jpg', 'n0155899300000677.jpg', 'n0155899300000678.jpg', 'n0155899300000683.jpg', 'n0155899300000686.jpg', 'n0155899300000688.jpg', 'n0155899300000692.jpg', 'n0155899300000693.jpg', 'n0155899300000694.jpg', 'n0155899300000695.jpg', 'n0155899300000696.jpg', 'n0155899300000697.jpg', 'n0155899300000699.jpg', 'n0155899300000701.jpg', 'n0155899300000704.jpg', 'n0155899300000705.jpg', 'n0155899300000706.jpg', 'n0155899300000711.jpg', 'n0155899300000712.jpg', 'n0155899300000714.jpg', 'n0155899300000715.jpg', 'n0155899300000716.jpg', 'n0155899300000718.jpg', 'n0155899300000719.jpg', 'n0155899300000721.jpg', 'n0155899300000725.jpg', 'n0155899300000727.jpg', 'n0155899300000728.jpg', 'n0155899300000732.jpg', 'n0155899300000734.jpg', 'n0155899300000736.jpg', 'n0155899300000737.jpg', 'n0155899300000738.jpg', 'n0155899300000740.jpg', 'n0155899300000741.jpg', 'n0155899300000742.jpg', 'n0155899300000749.jpg', 'n0155899300000753.jpg', 'n0155899300000761.jpg', 'n0155899300000763.jpg', 'n0155899300000765.jpg', 'n0155899300000766.jpg', 'n0155899300000771.jpg', 'n0155899300000777.jpg', 'n0155899300000780.jpg', 'n0155899300000783.jpg', 'n0155899300000785.jpg', 'n0155899300000788.jpg', 'n0155899300000790.jpg', 'n0155899300000792.jpg', 'n0155899300000794.jpg', 'n0155899300000796.jpg', 'n0155899300000797.jpg', 'n0155899300000806.jpg', 'n0155899300000807.jpg', 'n0155899300000808.jpg', 'n0155899300000811.jpg', 'n0155899300000812.jpg', 'n0155899300000813.jpg', 'n0155899300000816.jpg', 'n0155899300000817.jpg', 'n0155899300000822.jpg', 'n0155899300000824.jpg', 'n0155899300000827.jpg', 'n0155899300000828.jpg', 'n0155899300000829.jpg', 'n0155899300000830.jpg', 'n0155899300000831.jpg', 'n0155899300000833.jpg', 'n0155899300000835.jpg', 'n0155899300000837.jpg', 'n0155899300000838.jpg', 'n0155899300000844.jpg', 'n0155899300000847.jpg', 'n0155899300000849.jpg', 'n0155899300000852.jpg', 'n0155899300000853.jpg', 'n0155899300000854.jpg', 'n0155899300000859.jpg', 'n0155899300000861.jpg', 'n0155899300000864.jpg', 'n0155899300000865.jpg', 'n0155899300000866.jpg', 'n0155899300000869.jpg', 'n0155899300000871.jpg', 'n0155899300000874.jpg', 'n0155899300000875.jpg', 'n0155899300000876.jpg', 'n0155899300000882.jpg', 'n0155899300000883.jpg', 'n0155899300000889.jpg', 'n0155899300000891.jpg', 'n0155899300000897.jpg', 'n0155899300000900.jpg', 'n0155899300000901.jpg', 'n0155899300000902.jpg', 'n0155899300000904.jpg', 'n0155899300000907.jpg', 'n0155899300000908.jpg', 'n0155899300000911.jpg', 'n0155899300000912.jpg', 'n0155899300000913.jpg', 'n0155899300000914.jpg', 'n0155899300000915.jpg', 'n0155899300000916.jpg', 'n0155899300000919.jpg', 'n0155899300000920.jpg', 'n0155899300000922.jpg', 'n0155899300000924.jpg', 'n0155899300000925.jpg', 'n0155899300000928.jpg', 'n0155899300000930.jpg', 'n0155899300000931.jpg', 'n0155899300000932.jpg', 'n0155899300000934.jpg', 'n0155899300000936.jpg', 'n0155899300000937.jpg', 'n0155899300000939.jpg', 'n0155899300000940.jpg', 'n0155899300000941.jpg', 'n0155899300000944.jpg', 'n0155899300000948.jpg', 'n0155899300000949.jpg', 'n0155899300000952.jpg', 'n0155899300000954.jpg', 'n0155899300000955.jpg', 'n0155899300000958.jpg', 'n0155899300000959.jpg', 'n0155899300000964.jpg', 'n0155899300000965.jpg', 'n0155899300000966.jpg', 'n0155899300000968.jpg', 'n0155899300000969.jpg', 'n0155899300000970.jpg', 'n0155899300000974.jpg', 'n0155899300000975.jpg', 'n0155899300000977.jpg', 'n0155899300000982.jpg', 'n0155899300000985.jpg', 'n0155899300000986.jpg', 'n0155899300000987.jpg', 'n0155899300000988.jpg', 'n0155899300000996.jpg', 'n0155899300000997.jpg', 'n0155899300000999.jpg', 'n0155899300001000.jpg', 'n0155899300001004.jpg', 'n0155899300001005.jpg', 'n0155899300001006.jpg', 'n0155899300001008.jpg', 'n0155899300001009.jpg', 'n0155899300001011.jpg', 'n0155899300001012.jpg', 'n0155899300001016.jpg', 'n0155899300001018.jpg', 'n0155899300001024.jpg', 'n0155899300001025.jpg', 'n0155899300001026.jpg', 'n0155899300001027.jpg', 'n0155899300001028.jpg', 'n0155899300001030.jpg', 'n0155899300001031.jpg', 'n0155899300001034.jpg', 'n0155899300001036.jpg', 'n0155899300001037.jpg', 'n0155899300001041.jpg', 'n0155899300001042.jpg', 'n0155899300001044.jpg', 'n0155899300001047.jpg', 'n0155899300001049.jpg', 'n0155899300001051.jpg', 'n0155899300001057.jpg', 'n0155899300001058.jpg', 'n0155899300001059.jpg', 'n0155899300001061.jpg', 'n0155899300001063.jpg', 'n0155899300001064.jpg', 'n0155899300001073.jpg', 'n0155899300001074.jpg', 'n0155899300001077.jpg', 'n0155899300001080.jpg', 'n0155899300001082.jpg', 'n0155899300001083.jpg', 'n0155899300001084.jpg', 'n0155899300001085.jpg', 'n0155899300001089.jpg', 'n0155899300001095.jpg', 'n0155899300001096.jpg', 'n0155899300001098.jpg', 'n0155899300001100.jpg', 'n0155899300001103.jpg', 'n0155899300001106.jpg', 'n0155899300001108.jpg', 'n0155899300001110.jpg', 'n0155899300001111.jpg', 'n0155899300001112.jpg', 'n0155899300001119.jpg', 'n0155899300001120.jpg', 'n0155899300001122.jpg', 'n0155899300001124.jpg', 'n0155899300001126.jpg', 'n0155899300001131.jpg', 'n0155899300001132.jpg', 'n0155899300001134.jpg', 'n0155899300001135.jpg', 'n0155899300001137.jpg', 'n0155899300001138.jpg', 'n0155899300001139.jpg', 'n0155899300001141.jpg', 'n0155899300001142.jpg', 'n0155899300001143.jpg', 'n0155899300001147.jpg', 'n0155899300001151.jpg', 'n0155899300001154.jpg', 'n0155899300001158.jpg', 'n0155899300001159.jpg', 'n0155899300001161.jpg', 'n0155899300001162.jpg', 'n0155899300001163.jpg', 'n0155899300001166.jpg', 'n0155899300001167.jpg', 'n0155899300001168.jpg', 'n0155899300001171.jpg', 'n0155899300001172.jpg', 'n0155899300001176.jpg', 'n0155899300001177.jpg', 'n0155899300001178.jpg', 'n0155899300001180.jpg', 'n0155899300001182.jpg', 'n0155899300001183.jpg', 'n0155899300001186.jpg', 'n0155899300001189.jpg', 'n0155899300001190.jpg', 'n0155899300001192.jpg', 'n0155899300001193.jpg', 'n0155899300001194.jpg', 'n0155899300001196.jpg', 'n0155899300001197.jpg', 'n0155899300001199.jpg', 'n0155899300001203.jpg', 'n0155899300001204.jpg', 'n0155899300001207.jpg', 'n0155899300001210.jpg', 'n0155899300001217.jpg', 'n0155899300001219.jpg', 'n0155899300001225.jpg', 'n0155899300001227.jpg', 'n0155899300001230.jpg', 'n0155899300001233.jpg', 'n0155899300001235.jpg', 'n0155899300001238.jpg', 'n0155899300001239.jpg', 'n0155899300001240.jpg', 'n0155899300001241.jpg', 'n0155899300001245.jpg', 'n0155899300001246.jpg', 'n0155899300001247.jpg', 'n0155899300001264.jpg', 'n0155899300001273.jpg', 'n0155899300001278.jpg', 'n0155899300001279.jpg', 'n0155899300001281.jpg', 'n0155899300001283.jpg', 'n0155899300001287.jpg', 'n0155899300001291.jpg', 'n0155899300001293.jpg', 'n0155899300001295.jpg', 'n0155899300001297.jpg', 'n0155899300001299.jpg', 'n0155899300001300.jpg']

    '''

    class0 = [];  class1 = []
    for _ in range(0, 600) :

        src = cv2.imread(prefix+'/images/'+c0[_], cv2.IMREAD_COLOR)

        # 将图片 resize
        img_resize = cv2.resize(src, (84, 84))  # 84,84,3
        # 将 resize 的图片展示出来

        ll = list(np.reshape(img_resize, [21168]))
        for _ in range(len(ll)):
            ll[_] = np.float(ll[_]) / 255.0
        class0.append(ll)

    for _ in range(0, 600) :

        src = cv2.imread(prefix+'/images/'+c1[_], cv2.IMREAD_COLOR)

        # 将图片 resize
        img_resize = cv2.resize(src, (84, 84))  # 84,84,3
        # 将 resize 的图片展示出来

        ll = list(np.reshape(img_resize, [21168]))
        for _ in range(len(ll)):
            ll[_] = np.float(ll[_]) / 255.0
        class1.append(ll)


    return class0, class1


if __name__ == "__main__":
    prefix= "D:/prototypeNetTest/miniImage/mini-imagenet/"
    class0, class1 = readtwoclass(prefix)
    c0_trainx, c0_trainy, c0_testx, c0_testy = trainandsplit(class0, label=0)
    c1_trainx, c1_trainy, c1_testx, c1_testy = trainandsplit(class1, label=1)

    trainx = np.concatenate([c0_trainx, c1_trainx], axis=0)
    trainy = np.concatenate([c0_trainy, c1_trainy], axis=0)
    trainy = pd.DataFrame(list(map(int, trainy)), columns=['class'])

    testx = np.concatenate([c0_testx, c1_testx], axis=0)
    testy = np.concatenate([c0_testy, c1_testy], axis=0)
    testy = pd.DataFrame(list(map(int, testy)), columns=['class'])
    spe(trainx, trainy, testx, testy)
